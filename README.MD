Harika! Ã‡ok heycanlÄ±yÄ±m, scapy serisine baÅŸlÄ±yoruz. BÃ¶ylece ilerleyen zamanlarda yeni rojelerim olacak ve kendi wireless araÃ§larÄ±mÄ± kullanacaÄŸÄ±m. Bir kiÅŸinin Ã¶zel amaÃ§larÄ±nda ya da iÅŸ iÃ§in kendi araÃ§larÄ±nÄ± kullanmasÄ± kadar gÃ¼zel-tatmin edici bir duygu yok!

Scapy hakkÄ±nda temel bilgÃ¼ dÃ¼zeyinizin olduÄŸunu dÃ¼ÅŸÃ¼nerek tarihÃ§eini geÃ§iyorum. Bu serinin asÄ±l amacÄ± scapy ile wireless testlerinde Ã§okÃ§a kullandÄ±ÄŸÄ±mÄ±z air****ng serisie ait araÃ§larÄ±n Ã§alÄ±ÅŸma mantÄ±ÄŸÄ±nÄ± anlamak olacaktÄ±r. 

Bir wireless testine yaptÄ±ÄŸÄ±mÄ±z ilk iÅŸ belkide monitor mode'a aldÄ±ÄŸÄ±mÄ±z kart ile dump iÅŸlemleri yapmaktÄ±r. Ä°lgili SSID'leri tespit etmek ile baÅŸlarÄ±z. Scapy ile bu iÅŸlemi nasÄ±l yapabileceÄŸimizi gÃ¶sterek baÅŸlamak istiyorum. Seri boyunca KALI kullanacaÄŸÄ±m. Son bir not python ve wireless iÃ§in ekstra bir bilgi paylaÅŸÄ±mÄ±nda bulunmayacaÄŸÄ±m. Temel wireless gÃ¼venliÄŸi ve python programalam bildiÄŸinizi varsayorum.

```sh
â”Œâ”€â”€(rootðŸ’€kali)-[/home/sarikamyon]
â””â”€# iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

wlan0     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          Retry short  long limit:2   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          
```

Evet gÃ¶rÃ¼ldÃ¼ÄŸÃ¼ Ã¼zere wireless kartÄ± takÄ±lÄ±.

```sh
â”Œâ”€â”€(rootðŸ’€kali)-[/home/sarikamyon]
â””â”€# scapy                          
INFO: Can't import PyX. Won't be able to use psdump() or pdfdump().
                                      
                     aSPY//YASa       
             apyyyyCY//////////YCa       |
            sY//////YSpcs  scpCY//Pp     | Welcome to Scapy
 ayp ayyyyyyySCP//Pp           syY//C    | Version 2.4.4
 AYAsAYYYYYYYY///Ps              cY//S   |
         pCCCCY//p          cSSps y//Y   | https://github.com/secdev/scapy
         SPPPP///a          pP///AC//Y   |
              A//A            cyP////C   | Have fun!
              p///Ac            sC///a   |
              P////YCpc           A//A   | We are in France, we say Skappee.
       scccccp///pSP///p          p//Y   | OK? Merci.
      sY/////////y  caa           S//P   |             -- Sebastien Chabal
       cayCyayP//Ya              pY/Ya   |
        sY/PsY////YCc          aC//Yp 
         sc  sccaCY//PCypaapyCP//YSs  
                  spCPY//////YPSps    
                       ccaacs         
                                       using IPython 7.19.0
>>> 
```
Terminale `scapy` diyerek (sikiipi ÅŸeklinde telafuz edilir - sakÄ±n dÄ±ÅŸarda sÄ±kapi demeyin) scapy'nin kabuÄŸuna geÃ§iÅŸ yapalÄ±m.

Scapy ile bÃ¼yÃ¼k ihtimalle daha Ã¶necsined DDOS yapan bir araÃ§ yazmÄ±ÅŸ olabilirsiniz ya da var olan bir aracÄ±n iÃ§erisinde scapy'nin kullanldÄ±ÄŸÄ±nÄ± gÃ¶rmÃ¼ÅŸsÃ¼nÃ¼zdÃ¼r. enim ilk zamanlar aklÄ±ma hep ÅŸÃ¶yle bir soru gelirdi, diyelimki birden fazla aÄŸ adaptÃ¶rÃ¼m var scapy hangisi ile Ã§Ä±kÄ±ÅŸ yapacaÄŸÄ±nÄ± nerden biliyor? Biz ÅŸuanda eth0 ve wlan0 aÄŸ adaptÃ¶rlerine sahibiz, scapy bÃ¼yÃ¼k ihtimalle eth0 Ã¼zerinden iÅŸlem yapacaktÄ±r ancak ben wlan0 Ã¼zerinden iÅŸlem yapmasÄ±nÄ± istiyorum. Bu sayede monitor mode'a geÃ§iÅŸ yaptÄ±ÄŸÄ±mda sadece ilgili paketleri gÃ¶rebileceÄŸim. Ä°ÅŸte bunun cevabÄ± scapy'nin konfigÃ¼rasyonlarÄ±nda saklÄ±. Hemen bakalÄ±m.

```sh
>>> conf
ASN1_default_codec = <ASN1Codec BER[1]>
AS_resolver = <scapy.as_resolvers.AS_resolver_multi object at 0x7f264b35b790>
BTsocket   = <BluetoothRFCommSocket: read/write packets on a connected L2CAP...
L2listen   = <L2ListenSocket: read packets at layer 2 using Linux PF_PACKET ...
L2socket   = <L2Socket: read/write packets at layer 2 using Linux PF_PACKET ...
L3socket   = <L3PacketSocket: read/write packets at layer 3 using Linux PF_P...
L3socket6  = functools.partial(<L3PacketSocket: read/write packets at layer ...
USBsocket  = None
auto_crop_tables = True
auto_fragment = True
bufsize    = 65536
cache_iflist = {}
checkIPID  = False
checkIPaddr = True
checkIPinIP = True
checkIPsrc = True
check_TCPerror_seqack = False
color_theme = <DefaultTheme>
commands   = IPID_count : Identify IP id values classes in a list of packets...
contribs   = {}
crypto_valid = True
crypto_valid_advanced = True
debug_dissector = False
debug_match = False
debug_tls  = False
default_l2 = <class 'scapy.packet.Raw'>
dot15d4_protocol = None
emph       = <Emphasize []>
except_filter = ''
extensions_paths = '.'
fancy_prompt = True
filter     = ''
geoip_city = None
histfile   = '/root/.scapy_history'
iface      = 'eth0'
interactive = True
interactive_shell = ''
ipv6_enabled = True
l2types    = 0x0 -> Loopback (Loopback) 0x1 <- Dot3 (802.3) 0x1 <-> Ether (E...
l3types    = 0x3 -> IP (IP) 0x800 <-> IP (IP) 0x806 <-> ARP (ARP) 0x86dd <->...
layers     = Packet : <member 'name' of 'Packet' objects> NoPayload : <membe...
load_layers = ['bluetooth', 'bluetooth4LE', 'dhcp', 'dhcp6', 'dns', 'dot11',...
logLevel   = 20
loopback_name = 'lo'
mib        = <MIB - 343 elements>
min_pkt_size = 60
neighbor   = Ether -> LLC Dot3 -> LLC Dot3 -> SNAP Ether -> Dot1Q Ether -> A...
netcache   = arp_cache: 0 valid items. Timeout=120s in6_neighbor: 0 valid it...
noenum     = <Resolve []>
padding    = 1
padding_layer = <class 'scapy.packet.Padding'>
prog       = display = 'display' dot = 'dot' hexedit = 'hexer' ifconfig = 'i...
promisc    = True
prompt     = '>>> '
raise_no_dst_mac = False
raw_layer  = <class 'scapy.packet.Raw'>
raw_summary = False
recv_poll_rate = 0.05
resolve    = <Resolve []>
route      = Network Netmask Gateway Iface Output IP Metric 0.0.0.0 0.0.0.0 ...
route6     = Destination Next Hop Iface Src candidates Metric ::1/128 :: lo ...
session    = ''
sniff_promisc = 1
stats_classic_protocols = [<class 'scapy.layers.inet.TCP'>, <class 'scapy.la...
stats_dot11_protocols = [<class 'scapy.layers.inet.TCP'>, <class 'scapy.laye...
stealth    = 'not implemented'
temp_files = []
teredoPrefix = '2001::'
teredoServerPort = 3544
use_bpf    = False
use_npcap  = False
use_pcap   = False
use_pypy   = False
verb       = 2
version    = '2.4.4'
warning_threshold = 5
wepkey     = ''
>>> 

```
Harika bÃ¼tÃ¼n conf bilgilerini elde ettik. Åžimdi aradÄ±ÄŸÄ±mÄ±z conf'a bakalÄ±m.
```sh
>>> conf.iface
'eth0'

```

Evet tam da dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼mÃ¼z gibi! Wireless testlerine baÅŸlamak iÃ§in bu deÄŸiÅŸikliÄŸi yapmamÄ±z gerekectir. KartÄ±mÄ±zÄ± monitor mode'a alalÄ±m ve `conf.iface` ifaesini gÃ¼ncelleyelim. AyrÄ± bir terminal ekranÄ±nda gerekli iÅŸlemleri yapalÄ±m.

```sh
â”Œâ”€â”€(sarikamyonã‰¿kali)-[~]
â””â”€$ sudo su
[sudo] password for sarikamyon: 
â”Œâ”€â”€(rootðŸ’€kali)-[/home/sarikamyon]
â””â”€# airmon-ng                         

PHY	Interface	Driver		Chipset

phy0	wlan0		rt2800usb	Ralink Technology, Corp. RT5372

                                                                                                                                                                                                                                              
â”Œâ”€â”€(rootðŸ’€kali)-[/home/sarikamyon]
â””â”€# airmon-ng check kill 

Killing these processes:

    PID Name
   1111 wpa_supplicant

                                                                                                                                                                                                                                              
â”Œâ”€â”€(rootðŸ’€kali)-[/home/sarikamyon]
â””â”€# airmon-ng start wlan0


PHY	Interface	Driver		Chipset

phy0	wlan0		rt2800usb	Ralink Technology, Corp. RT5372
		(mac80211 monitor mode vif enabled for [phy0]wlan0 on [phy0]wlan0mon)
		(mac80211 station mode vif disabled for [phy0]wlan0)


â”Œâ”€â”€(rootðŸ’€kali)-[/home/sarikamyon]
â””â”€# iwconfig                                                                                                                                                                                                                            237 â¨¯
lo        no wireless extensions.

eth0      no wireless extensions.

wlan0mon  IEEE 802.11  Mode:Monitor  Frequency:2.457 GHz  Tx-Power=20 dBm   
          Retry short  long limit:2   RTS thr:off   Fragment thr:off
          Power Management:off

```

Harika ÅŸimdi gÃ¼ncellememizi yapalÄ±m.
```sh
>>> conf.iface = 'wlan0mon'
>>> 
>>> 
>>> conf.iface
'wlan0mon'
```
ArtÄ±k ilk sniffimizi yapabiliriz.

```sh
>>> Pkts = sniff(count=1)
>>> 
>>> Pkts
<Sniffed: TCP:0 UDP:0 ICMP:0 Other:1>
>>> 
>>> Pkts.summary()
RadioTap / 802.11 Control Block Ack Request 5c:63:bf:56:81:bc (TA) > 7c:23:02:d0:f0:3a (RA) / Raw
>>> 

```

Harika deÄŸil mi? Ne kadar da kolay! Hadi 10 adet sniff yapalÄ±m.

```sh
>>> pkts =sniff(10)
>>> 
>>> pkts.nsummary()
0000 RadioTap / 802.11 Management Beacon 5c:63:bf:56:81:bc (TA=SA) > ff:ff:ff:ff:ff:ff (RA=DA) / Dot11Beacon / SSID='TurkTelekom_T3AA9' / Dot11EltRates / Dot11EltDSSSet / Dot11Elt / Dot11EltERP / Dot11Elt / Dot11EltRSN / Dot11EltRates / Dot11EltHTCapabilities / Dot11Elt / Dot11Elt / Dot11Elt / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltMicrosoftWPA / Dot11EltVendorSpecific / Dot11Elt
0001 RadioTap / 802.11 Management Beacon 5c:63:bf:56:81:bc (TA=SA) > ff:ff:ff:ff:ff:ff (RA=DA) / Dot11Beacon / SSID='TurkTelekom_T3AA9' / Dot11EltRates / Dot11EltDSSSet / Dot11Elt / Dot11EltERP / Dot11Elt / Dot11EltRSN / Dot11EltRates / Dot11EltHTCapabilities / Dot11Elt / Dot11Elt / Dot11Elt / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltMicrosoftWPA / Dot11EltVendorSpecific / Dot11Elt
0002 RadioTap / 802.11 Management Beacon b4:1c:30:77:e9:e4 (TA=SA) > ff:ff:ff:ff:ff:ff (RA=DA) / Dot11Beacon / SSID='Superbox_Wifi_4619' / Dot11EltRates / Dot11EltDSSSet / Dot11Elt / Dot11EltCountry / Dot11EltERP / Dot11EltRates / Dot11Elt / Dot11EltHTCapabilities / Dot11Elt / Dot11Elt / Dot11Elt / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltRSN / Dot11EltVendorSpecific
0003 RadioTap / 802.11 Control Ack 00:00:00:00:00:00 (TA) > 1c:cc:d6:76:de:c9 (RA)
0004 RadioTap / 802.11 Control Ack 00:00:00:00:00:00 (TA) > 56:62:82:44:9f:7d (RA)
0005 RadioTap / 802.11 Management Beacon 5c:63:bf:0e:f3:90 (TA=SA) > ff:ff:ff:ff:ff:ff (RA=DA) / Dot11Beacon / SSID='TurkTelekom_T478D' / Dot11EltRates / Dot11EltDSSSet / Dot11Elt / Dot11EltERP / Dot11Elt / Dot11EltRSN / Dot11EltRates / Dot11EltHTCapabilities / Dot11Elt / Dot11Elt / Dot11Elt / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltMicrosoftWPA / Dot11EltVendorSpecific / Dot11Elt
0006 RadioTap / 802.11 Control Ack 00:00:00:00:00:00 (TA) > 56:62:82:44:9f:7d (RA)
0007 RadioTap / 802.11 Management Beacon 5c:63:bf:56:81:bc (TA=SA) > ff:ff:ff:ff:ff:ff (RA=DA) / Dot11Beacon / SSID='TurkTelekom_T3AA9' / Dot11EltRates / Dot11EltDSSSet / Dot11Elt / Dot11EltERP / Dot11Elt / Dot11EltRSN / Dot11EltRates / Dot11EltHTCapabilities / Dot11Elt / Dot11Elt / Dot11Elt / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltMicrosoftWPA / Dot11EltVendorSpecific / Dot11Elt
0008 RadioTap / 802.11 Management Beacon b4:1c:30:77:e9:e4 (TA=SA) > ff:ff:ff:ff:ff:ff (RA=DA) / Dot11Beacon / SSID='Superbox_Wifi_4619' / Dot11EltRates / Dot11EltDSSSet / Dot11Elt / Dot11EltCountry / Dot11EltERP / Dot11EltRates / Dot11Elt / Dot11EltHTCapabilities / Dot11Elt / Dot11Elt / Dot11Elt / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltRSN / Dot11EltVendorSpecific
0009 RadioTap / 802.11 Management Beacon b4:1c:30:77:e9:e4 (TA=SA) > ff:ff:ff:ff:ff:ff (RA=DA) / Dot11Beacon / SSID='Superbox_Wifi_4619' / Dot11EltRates / Dot11EltDSSSet / Dot11Elt / Dot11EltCountry / Dot11EltERP / Dot11EltRates / Dot11Elt / Dot11EltHTCapabilities / Dot11Elt / Dot11Elt / Dot11Elt / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltRSN / Dot11EltVendorSpecific
>>> 
```

Harika sniff iÅŸleminde bazÄ± SSID'leri yakaladÄ±k. Bir sonraki yazÄ±da bunar bir python projesi ile nasÄ±l yapabileceÄŸimizi gÃ¶receÄŸiz.

